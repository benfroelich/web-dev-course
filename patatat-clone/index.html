<!DOCTYPE html>
<html>
<head>
	<title>patatat clone</title>
	<link rel="stylesheet" type="text/css" href="assets/css/patatat-clone.css">
	<script type="text/javascript" src="assets/js/lib/paperjs/dist/paper-full.js"></script>
	<script src="assets/js/lib/howler.js/dist/howler.js"></script>
  	<!-- <script type="text/paperscript" canvas="main-canvas" src="assets/js/patatat-clone-paperscript.js"></script> 	 -->
 	<script type="text/paperscript" canvas="main-canvas">
 	<!-- <script type="text/javascript" canvas="main-canvas"> -->
 		//var circles = new Array();
 		var numX = 10;
 		var numY = 10;
 		var spacingX = 100;
 		var spacingY = 100;
 		var radius = 8;
 		var circleColor = "aquamarine";

 		// maps keys to animations and sounds
 		var KeyEvents = [];
 		KeyEvent.prototype.pathToAudio = "assets/media/sounds/";
 		KeyEvents["a"] = (new KeyEvent("bubbles.mp3"));
 		KeyEvents["o"] = (new KeyEvent("clay.mp3"));
 		KeyEvents["e"] = (new KeyEvent("confetti.mp3"));
 		KeyEvents["u"] = (new KeyEvent("snore-1.mp3"));
 		KeyEvents["i"] = (new KeyEvent("snore-2.mp3"));
 		KeyEvents["d"] = (new KeyEvent("fart-03.mp3"));

 		// store a list of currently running animations
 		var activeAnimations = [];

 		// sound - sound to play when pressed
 		// colorFunction [optional] - TBD
 		function KeyEvent(sound, colorFunction) {
 			this.sound = new Howl({
 				src: [this.pathToAudio + sound]
 			});

 			if(colorFunction !== undefined) 
 			{
 				this.colorFunction = colorFunction;
 			}
 			else 
 			{
 				this.colorFunction = (function () {
 					alert("default color function");
 				});
 			}
 		}

 		// create a new animation and play the sound
 		KeyEvent.prototype.spawn = function () {
 			// play audio
 			this.sound.play();
 			// create animation
 			activeAnimations.push(new Path.Circle({
				center: new Point.random() * view.size,
				radius: 50,
				fillColor: 'red'
			}));	
 		}

 		function onFrame(event) {
 			for (var i = activeAnimations.length - 1; i >= 0; i--) {
 				activeAnimations[i].scale(0.92);
 				activeAnimations[i].fillColor.hue += 2;
 				// once the circle has reduced to < 1 pixel in area, completely remove it
 				if(activeAnimations[i].area < 1) 
 				{
 					// remove the element from display and list
 					activeAnimations[i].remove();
 					activeAnimations.splice(i, 1);
 				}
  			}
 		}

 		function onKeyDown(event) {
 			// when a key is pressed, screen it for a sound and animation enabled key
 			if(event.key in KeyEvents)
 				KeyEvents[event.key].spawn();
 		}
 	</script>
</head>
<body>
	<canvas id="main-canvas"></canvas>
</body>
</html>